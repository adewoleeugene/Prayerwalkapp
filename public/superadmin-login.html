<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Superadmin Login</title>
  <style>
    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; background: #f3f5f9; color: #1f2937; }
    .wrap { min-height: 100vh; display: grid; place-items: center; padding: 20px; }
    .card { width: 100%; max-width: 420px; background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px; }
    h1 { margin: 0 0 6px; font-size: 24px; }
    p { margin: 0 0 16px; color: #6b7280; }
    label { display: block; margin: 10px 0 6px; font-size: 14px; font-weight: 600; }
    input { width: 100%; box-sizing: border-box; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; }
    button { margin-top: 14px; width: 100%; border: none; border-radius: 8px; padding: 10px 12px; background: #111827; color: #fff; font-weight: 700; cursor: pointer; }
    .error { margin-top: 10px; color: #b91c1c; font-size: 13px; min-height: 18px; }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card">
      <h1>Superadmin Login</h1>
      <p>Overseer access</p>
      <form id="loginForm">
        <label for="email">Username (email)</label>
        <input id="email" name="email" type="email" required autocomplete="username" />
        <label for="password">Password</label>
        <input id="password" name="password" type="password" required autocomplete="current-password" />
        <button type="submit">Login</button>
      </form>
      <div class="error" id="error"></div>
    </section>
  </main>
  <script>
    const form = document.getElementById('loginForm');
    const errorEl = document.getElementById('error');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      errorEl.textContent = '';

      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;

      try {
        const res = await fetch('/auth/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });
        const data = await res.json();

        if (!res.ok || !data.success) {
          errorEl.textContent = data.error || 'Login failed';
          return;
        }

        if (data.user.role !== 'superadmin') {
          errorEl.textContent = 'This account is not a superadmin.';
          return;
        }

        localStorage.setItem('adminToken', data.token);
        localStorage.setItem('adminUserRole', data.user.role || '');
        localStorage.setItem('adminUserEmail', data.user.email || '');
        window.location.href = '/admin.html';
      } catch (err) {
        errorEl.textContent = 'Network error. Try again.';
      }
    });
  </script>
</body>
</html>
